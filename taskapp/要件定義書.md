# Todoアプリ 要件定義書

## 📋 概要
Vue.jsのキャッチアップを目的として作成するTodoアプリ。
バックエンドとの連携も行い、基本的なCRUD操作とフィルタリング機能を実装する。

公開予定は無いため、アカウント関連の機能はなし。
Todoの管理機能だけを作成する。

## 🎯 目的
アプリの作成を通して、以下のVue.jsの機能・概念を習得する：
- コンポーネント設計
- 状態管理（Pinia）
- ルーティング（Vue Router）
- フォームバリデーション
- API連携（非同期処理）
- イベントハンドリング
- リアクティブなデータバインディング

## 🛠 技術スタック

### フロントエンド
- **フレームワーク**: Vue.js 3.x（Composition API）
- **状態管理**: Pinia
- **ルーティング**: Vue Router
- **UIライブラリ**: 任意（例: Vuetify, Element Plus, または素のCSS）
- **HTTPクライアント**: Axios
- **ビルドツール**: Vite

### バックエンド
- **言語・フレームワーク**: Node.js + Express（推奨）または任意
- **データベース**: PostgreSQL または MySQL
- **ORM**: Prisma または Sequelize（推奨）

### 開発環境
- **バージョン管理**: Git
- **コンテナ**: Docker + Docker Compose（任意）
- **パッケージマネージャー**: npm または pnpm

## 📱 機能一覧

| カテゴリー | 機能概要 | 機能詳細 | 優先度 |
|----------|---------|---------|--------|
| Todo管理 | 一覧表示 | Todoの一覧を表示する | 高 |
| Todo管理 | 新規作成 | 新しいTodoを作成できる | 高 |
| Todo管理 | 編集 | 既存のTodoを編集できる | 高 |
| Todo管理 | 削除 | 既存のTodoを削除できる（物理削除） | 高 |
| Todo管理 | ステータス変更 | Todoのステータスを変更できる（未着手→進行中→完了） | 高 |
| フィルタリング | ステータスフィルタ | ステータスでTodoを絞り込む | 中 |
| フィルタリング | タグフィルタ | タグでTodoを絞り込む | 中 |
| ソート | 並び替え | 作成日、期限日、更新日でソート可能 | 中 |
| 検索 | キーワード検索 | タイトル・説明文で検索できる | 低 |
| Label管理 | Label一覧表示 | 登録済みのLabelを表示 | 中 |
| Label管理 | Label作成 | 新しいLabelを作成できる | 中 |
| Label管理 | Label削除 | Labelを削除できる | 低 |

## 📊 データモデル

### Todo
| フィールド名 | 型 | 必須 | 説明 |
|------------|------|------|------|
| id | number | ○ | 主キー（自動生成） |
| title | string | ○ | Todoのタイトル（最大100文字） |
| description | string | - | Todoの詳細説明（最大1000文字） |
| status | enum | ○ | ステータス: `'todo'` / `'in_progress'` / `'completed'` |
| labels | Array<Label> | - | 紐づくラベルの配列 |
| due_date | Date | - | 期限日（start_dateより後である必要がある） |
| start_date | Date | - | 開始日（due_dateより前である必要がある） |
| created_at | Date | ○ | 作成日時（自動生成） |
| updated_at | Date | ○ | 更新日時（自動更新） |
| completed_at | Date | - | 完了日時（statusが'completed'になった時刻） |

**バリデーションルール:**
- `title`: 必須、1文字以上100文字以内
- `description`: 任意、1000文字以内
- `status`: デフォルト値は `'todo'`
- `start_date` < `due_date` （両方設定されている場合）
- `completed_at` は `status === 'completed'` の場合のみ設定

### Label
| フィールド名 | 型 | 必須 | 説明 |
|------------|------|------|------|
| id | number | ○ | 主キー（自動生成） |
| name | string | ○ | ラベル名（最大30文字、ユニーク） |
| color | string | - | カラーコード（例: `#FF5733`） |
| created_at | Date | ○ | 作成日時（自動生成） |
| updated_at | Date | ○ | 更新日時（自動更新） |

**バリデーションルール:**
- `name`: 必須、1文字以上30文字以内、重複不可
- `color`: 任意、有効なHEXカラーコード形式

### リレーション
- Todo と Label は多対多（中間テーブル: `todo_labels`）

## 🔌 APIエンドポイント設計

### Todo関連

| メソッド | エンドポイント | 説明 | リクエストボディ | レスポンス |
|---------|--------------|------|----------------|-----------|
| GET | `/api/todos` | Todo一覧取得 | - | `{ todos: Todo[] }` |
| GET | `/api/todos?status=todo` | ステータスでフィルタ | - | `{ todos: Todo[] }` |
| GET | `/api/todos?labelId=1` | ラベルでフィルタ | - | `{ todos: Todo[] }` |
| GET | `/api/todos?sort=due_date&order=asc` | ソート付き取得 | - | `{ todos: Todo[] }` |
| GET | `/api/todos/:id` | Todo詳細取得 | - | `{ todo: Todo }` |
| POST | `/api/todos` | Todo新規作成 | `{ title, description?, status?, labels?, due_date?, start_date? }` | `{ todo: Todo }` |
| PUT | `/api/todos/:id` | Todo更新 | `{ title?, description?, status?, labels?, due_date?, start_date? }` | `{ todo: Todo }` |
| DELETE | `/api/todos/:id` | Todo削除 | - | `{ message: "success" }` |

### Label関連

| メソッド | エンドポイント | 説明 | リクエストボディ | レスポンス |
|---------|--------------|------|----------------|-----------|
| GET | `/api/labels` | Label一覧取得 | - | `{ labels: Label[] }` |
| POST | `/api/labels` | Label新規作成 | `{ name, color?  }` | `{ label: Label }` |
| DELETE | `/api/labels/:id` | Label削除 | - | `{ message: "success" }` |

### エラーレスポンス形式
```json
{
  "error": {
    "message": "エラーメッセージ",
    "code": "ERROR_CODE",
    "details": {}
  }
}
```

**HTTPステータスコード:**
- `200`: 成功
- `201`: 作成成功
- `400`: バリデーションエラー
- `404`: リソースが見つからない
- `500`: サーバーエラー

## 🎨 画面構成

### 1. Todo一覧画面（メイン画面）
**パス**: `/`

**表示要素:**
- Todo一覧テーブル/カード
  - タイトル
  - ステータス（バッジ表示）
  - ラベル（複数表示可能）
  - 期限日
  - 編集ボタン
  - 削除ボタン
  - ステータス変更ボタン
- 新規作成ボタン
- フィルタリングUI
  - ステータス選択（全て/未着手/進行中/完了）
  - ラベル選択（複数選択可能）
- ソートUI
  - 作成日順
  - 更新日順
  - 期限日順
  - 昇順/降順切り替え
- 検索バー（任意実装）

### 2. Todo作成/編集モーダル（またはページ）
**パス**: `/todos/new`, `/todos/:id/edit`（ページの場合）

**入力フォーム:**
- タイトル（必須、テキスト入力）
- 説明（任意、テキストエリア）
- ステータス（ドロップダウン）
- ラベル（複数選択可能なセレクトボックス）
- 開始日（日付ピッカー）
- 期限日（日付ピッカー）
- 保存ボタン
- キャンセルボタン

**バリデーション表示:**
- リアルタイムバリデーション
- エラーメッセージの表示

### 3. Label管理画面（任意）
**パス**: `/labels`

**表示要素:**
- Label一覧
  - 名前
  - カラー（色付きバッジ）
  - 削除ボタン
- Label作成フォーム
  - 名前入力
  - カラーピッカー
  - 作成ボタン

## 🔄 状態管理設計（Pinia）

### todoStore
```typescript
{
  state: {
    todos: Todo[],
    loading: boolean,
    error: string | null,
    filters: {
      status: string | null,
      labelIds: number[],
      searchKeyword: string
    },
    sort: {
      field: 'created_at' | 'updated_at' | 'due_date',
      order: 'asc' | 'desc'
    }
  },
  actions: {
    fetchTodos(),
    createTodo(todo),
    updateTodo(id, todo),
    deleteTodo(id),
    setFilter(filters),
    setSort(sort)
  },
  getters: {
    filteredTodos(),
    completedTodos(),
    inProgressTodos(),
    todoTodos()
  }
}
```

### labelStore
```typescript
{
  state: {
    labels: Label[],
    loading: boolean,
    error: string | null
  },
  actions: {
    fetchLabels(),
    createLabel(label),
    deleteLabel(id)
  }
}
```

## ✅ 非機能要件

### パフォーマンス
- 初期ローディング時間: 2秒以内
- Todo一覧表示: 100件まで快適に動作
- API応答時間: 500ms以内

### ユーザビリティ
- レスポンシブデザイン（モバイル対応は任意）
- 直感的なUI/UX
- 操作に対する適切なフィードバック（ローディング表示、成功/エラーメッセージ）

### エラーハンドリング
- API通信失敗時のエラーメッセージ表示
- バリデーションエラーの分かりやすい表示
- ネットワークエラー時のリトライ機能（任意）

### セキュリティ
- XSS対策（Vue.jsの標準機能で対応）
- SQLインジェクション対策（ORMの使用）
- CORS設定

## 🚀 開発フェーズ

### Phase 1: 基本機能実装（必須）
- [ ] プロジェクトセットアップ
- [ ] データベース設計・構築
- [ ] バックエンドAPI実装（CRUD）
- [ ] フロントエンド基本構成
- [ ] Todo一覧表示
- [ ] Todo作成機能
- [ ] Todo編集機能
- [ ] Todo削除機能

### Phase 2: 拡張機能実装（推奨）
- [ ] ステータス管理機能
- [ ] Label管理機能
- [ ] Todo-Label紐づけ
- [ ] フィルタリング機能
- [ ] ソート機能
- [ ] バリデーション強化
- [ ] エラーハンドリング

### Phase 3: 改善・最適化（任意）
- [ ] 検索機能
- [ ] ページネーション
- [ ] UI/UXの改善
- [ ] パフォーマンス最適化
- [ ] テストコード作成

## 📝 備考
- 認証機能は実装しない
- デプロイは行わず、ローカル環境での動作を想定
- コードの可読性と保守性を重視
- Vue.jsのベストプラクティスに従う
- Git commitは機能単位で細かく行う

## 📚 参考リソース
- [Vue.js公式ドキュメント](https://ja.vuejs.org/)
- [Pinia公式ドキュメント](https://pinia.vuejs.org/)
- [Vue Router公式ドキュメント](https://router.vuejs.org/)
